<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
<ol start="2" style="list-style-type: decimal">
<li>Reading, Writing and Converting Simple Features</li>
</ol> • sf</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="&lt;ol start=" style="list-style-type: decimal">
</head>
<body>
<li>Reading, Writing and Converting Simple Features</li>
" /&gt;

<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sf</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.6.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sf1.html">1. Simple Features for R</a>
    </li>
    <li>
      <a href="../articles/sf2.html">2. Reading, Writing and Converting Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf3.html">3. Manipulating Simple Feature Geometries</a>
    </li>
    <li>
      <a href="../articles/sf4.html">4. Manipulating Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf5.html">5. Plotting Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf6.html">6. Miscellaneous</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-spatial/sf/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1><ol start="2" style="list-style-type: decimal">
<li>Reading, Writing and Converting Simple Features</li>
</ol></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-spatial/sf//blob/master/vignettes/sf2.Rmd"><code>vignettes/sf2.Rmd</code></a></small>
      <div class="hidden name"><code>sf2.Rmd</code></div>

    </div>

    
    
<p>This vignetted describes how simple features can be read in R from files or databases, and how they can be converted to other formats (text, <a href="https://cran.r-project.org/package=sp">sp</a>)</p>
<div id="reading-and-writing-through-gdal" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-and-writing-through-gdal" class="anchor"></a>Reading and writing through GDAL</h2>
<p>The Geospatial Data Abstraction Library (<a href="http://www.gdal.org/">GDAL</a>) is the swiss army knife for spatial data: it reads and writes vector and raster data from and to practically every file format, or database, of significance. Package <code>sf</code> reads and writes using GDAL by the functions <code>st_read</code> and <code>st_write</code>.</p>
<p>The data model GDAL uses needs</p>
<ul>
<li>a data source, which may be a file, directory, or database</li>
<li>a layer, which is a single geospatial dataset inside a file or directory or e.g. a table in a database.</li>
<li>the specification of a driver (i.e., which format)</li>
<li>driver-specific reading or writing data sources, or layers</li>
</ul>
<p>This may sound complex, but it is needed to map to over 200 data formats! Package <code>sf</code> tries hard to simplify this where possible (e.g. a file contains a single layer), but this vignette will try to point you to the options.</p>
<div id="using-st_read" class="section level3">
<h3 class="hasAnchor">
<a href="#using-st_read" class="anchor"></a>Using st_read</h3>
<p>As an example, we read the North Carolina counties SIDS dataset, which comes shipped with the <code>sf</code> package by:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sf)
## Linking to GEOS 3.5.0, GDAL 2.2.2, proj.4 4.8.0
fname &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"shape/nc.shp"</span>, <span class="dt">package=</span><span class="st">"sf"</span>)
fname
## [1] "/tmp/Rtmp6RHbFm/temp_libpath6ec8267cb58c/sf/shape/nc.shp"
nc &lt;-<span class="st"> </span><span class="kw">st_read</span>(fname)
## Reading layer `nc' from data source `/tmp/Rtmp6RHbFm/temp_libpath6ec8267cb58c/sf/shape/nc.shp' using driver `ESRI Shapefile'
## Simple feature collection with 100 features and 14 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965
## epsg (SRID):    4267
## proj4string:    +proj=longlat +datum=NAD27 +no_defs</code></pre></div>
<p>Typical users will use a file name with path for <code>fname</code>, or first set R’s working directory with <code>setwd()</code> and use file name without path.</p>
<p>We see here that a single argument is used to find both the datasource and the layer. This works when the datasource contains a single layer. In case the number of layers is zero (e.g. a database with no tables), an error message is given. In case there are more layers than one, the first layer is returned, but a message and a warning are given:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">st_read</span>(<span class="st">"PG:dbname=postgis"</span>)
Multiple layers are present in data source PG:dbname=postgis, reading layer <span class="st">`</span><span class="dt">meuse'.</span>
<span class="dt">Use </span><span class="st">`</span>st_layers<span class="st">' to list all layer names and their type in a data source.</span>
<span class="st">Set the `layer'</span> argument in <span class="st">`</span><span class="dt">st_read' to read a particular layer.</span>
<span class="dt">Reading layer </span><span class="st">`</span>meuse<span class="st">' from data source `PG:dbname=postgis'</span> using driver <span class="st">`</span><span class="dt">PostgreSQL'</span>
<span class="dt">Simple feature collection with 155 features and 12 fields</span>
<span class="dt">geometry type:  POINT</span>
<span class="dt">dimension:      XY</span>
<span class="dt">bbox:           xmin: 178605 ymin: 329714 xmax: 181390 ymax: 333611</span>
<span class="dt">epsg (SRID):    28992</span>
<span class="dt">proj4string:    +proj=sterea +lat_0=52.15616055555555 ...</span>
<span class="dt">Warning message:</span>
<span class="dt">In eval(substitute(expr), envir, enclos) :</span>
<span class="dt">  automatically selected the first layer in a data source containing more than one.</span></code></pre></div>
<p>The message points to the <code>st_layers</code> command, which lists the driver and layers in a datasource, e.g.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw"><a href="../reference/st_layers.html">st_layers</a></span>(<span class="st">"PG:dbname=postgis"</span>)
Driver:<span class="st"> </span>PostgreSQL 
Available layers:
<span class="st">  </span>layer_name geometry_type features fields
<span class="dv">1</span>      meuse         Point      <span class="dv">155</span>     <span class="dv">12</span>
<span class="dv">2</span>   meuse_sf         Point      <span class="dv">155</span>     <span class="dv">12</span>
<span class="dv">3</span>       sids Multi Polygon      <span class="dv">100</span>     <span class="dv">14</span>
<span class="dv">4</span>  meuse_tbl         Point      <span class="dv">155</span>     <span class="dv">13</span>
<span class="dv">5</span> meuse_tbl2         Point      <span class="dv">155</span>     <span class="dv">13</span>
&gt;<span class="st"> </span></code></pre></div>
<p>A particular layer can now be read by e.g.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">st_read</span>(<span class="st">"PG:dbname=postgis"</span>, <span class="st">"sids"</span>)</code></pre></div>
<p><code>st_layers</code> has the option to count the number of features in case these are missing: some datasources (e.g. OSM xml files) do not report the number of features, but need to be completely read for this. GDAL allows for more than one geometry column for a feature layer; these are reported by <code>st_layers</code>.</p>
<p>In case a layer contains only geometries but no attributes (fields), <code>st_read</code> still returns an <code>sf</code> object, with a geometry column only.</p>
<p>We see that GDAL automatically detects the driver (file format) of the datasource, by trying them all in turn.</p>
<p><code>st_read</code> follows the conventions of base R, similar to how it reads tabular data into <code>data.frame</code>s. This means that character data are read, by default as <code>factor</code>s. For those who insist on retrieving character data as character vectors, the argument <code>stringsAsFactors</code> can be set to <code>FALSE</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">st_read</span>(fname, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Alternatively, a user can set the global option <code>stringsAsFactors</code>, and this will have the same effect:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">st_read</span>(fname)
## Reading layer `nc' from data source `/tmp/Rtmp6RHbFm/temp_libpath6ec8267cb58c/sf/shape/nc.shp' using driver `ESRI Shapefile'
## Simple feature collection with 100 features and 14 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965
## epsg (SRID):    4267
## proj4string:    +proj=longlat +datum=NAD27 +no_defs</code></pre></div>
</div>
<div id="using-st_write" class="section level3">
<h3 class="hasAnchor">
<a href="#using-st_write" class="anchor"></a>Using st_write</h3>
<p>To write a simple features object to a file, we need at least two arguments, the object and a filename:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">st_write</span>(nc, <span class="st">"nc1.shp"</span>)</code></pre></div>
<p>The file name is taken as the data source name. The default for the layer name is the basename (filename without path) of the the data source name. For this, <code>st_write</code> needs to guess the driver. The above command is, for instance, equivalent to:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">st_write</span>(nc, <span class="dt">dsn =</span> <span class="st">"nc1.shp"</span>, <span class="dt">layer =</span> <span class="st">"nc.shp"</span>, <span class="dt">driver =</span> <span class="st">"ESRI Shapefile"</span>)
## Writing layer `nc' to data source `nc1.shp' using driver `ESRI Shapefile'
## features:       100
## fields:         14
## geometry type:  Multi Polygon</code></pre></div>
<p>How the guessing of drivers works is explained in the next section.</p>
</div>
<div id="guessing-a-driver-for-output" class="section level3">
<h3 class="hasAnchor">
<a href="#guessing-a-driver-for-output" class="anchor"></a>Guessing a driver for output</h3>
<p>The output driver is guessed from the datasource name, either from its extension (<code>.shp</code>: <code>ESRI Shapefile</code>), or its prefix (<code>PG:</code>: <code>PostgreSQL</code>). The list of extensions with corresponding driver (short driver name) is:</p>
<table class="table">
<thead><tr class="header">
<th align="left">extension</th>
<th align="left">driver short name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>bna</code></td>
<td align="left"><code>BNA</code></td>
</tr>
<tr class="even">
<td align="left"><code>csv</code></td>
<td align="left"><code>CSV</code></td>
</tr>
<tr class="odd">
<td align="left"><code>e00</code></td>
<td align="left"><code>AVCE00</code></td>
</tr>
<tr class="even">
<td align="left"><code>gdb</code></td>
<td align="left"><code>FileGDB</code></td>
</tr>
<tr class="odd">
<td align="left"><code>geojson</code></td>
<td align="left"><code>GeoJSON</code></td>
</tr>
<tr class="even">
<td align="left"><code>gml</code></td>
<td align="left"><code>GML</code></td>
</tr>
<tr class="odd">
<td align="left"><code>gmt</code></td>
<td align="left"><code>GMT</code></td>
</tr>
<tr class="even">
<td align="left"><code>gpkg</code></td>
<td align="left"><code>GPKG</code></td>
</tr>
<tr class="odd">
<td align="left"><code>gps</code></td>
<td align="left"><code>GPSBabel</code></td>
</tr>
<tr class="even">
<td align="left"><code>gtm</code></td>
<td align="left"><code>GPSTrackMaker</code></td>
</tr>
<tr class="odd">
<td align="left"><code>gxt</code></td>
<td align="left"><code>Geoconcept</code></td>
</tr>
<tr class="even">
<td align="left"><code>jml</code></td>
<td align="left"><code>JML</code></td>
</tr>
<tr class="odd">
<td align="left"><code>map</code></td>
<td align="left"><code>WAsP</code></td>
</tr>
<tr class="even">
<td align="left"><code>mdb</code></td>
<td align="left"><code>Geomedia</code></td>
</tr>
<tr class="odd">
<td align="left"><code>nc</code></td>
<td align="left"><code>netCDF</code></td>
</tr>
<tr class="even">
<td align="left"><code>ods</code></td>
<td align="left"><code>ODS</code></td>
</tr>
<tr class="odd">
<td align="left"><code>osm</code></td>
<td align="left"><code>OSM</code></td>
</tr>
<tr class="even">
<td align="left"><code>pbf</code></td>
<td align="left"><code>OSM</code></td>
</tr>
<tr class="odd">
<td align="left"><code>shp</code></td>
<td align="left"><code>ESRI Shapefile</code></td>
</tr>
<tr class="even">
<td align="left"><code>sqlite</code></td>
<td align="left"><code>SQLite</code></td>
</tr>
<tr class="odd">
<td align="left"><code>vdv</code></td>
<td align="left"><code>VDV</code></td>
</tr>
<tr class="even">
<td align="left"><code>xls</code></td>
<td align="left"><code>xls</code></td>
</tr>
<tr class="odd">
<td align="left"><code>xlsx</code></td>
<td align="left"><code>XLSX</code></td>
</tr>
</tbody>
</table>
<p>The list with prefixes is:</p>
<table class="table">
<thead><tr class="header">
<th align="left">prefix</th>
<th align="left">driver short name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>couchdb:</code></td>
<td align="left"><code>CouchDB</code></td>
</tr>
<tr class="even">
<td align="left"><code>DB2ODBC:</code></td>
<td align="left"><code>DB2ODBC</code></td>
</tr>
<tr class="odd">
<td align="left"><code>DODS:</code></td>
<td align="left"><code>DODS</code></td>
</tr>
<tr class="even">
<td align="left"><code>GFT:</code></td>
<td align="left"><code>GFT</code></td>
</tr>
<tr class="odd">
<td align="left"><code>MSSQL:</code></td>
<td align="left"><code>MSSQLSpatial</code></td>
</tr>
<tr class="even">
<td align="left"><code>MySQL:</code></td>
<td align="left"><code>MySQL</code></td>
</tr>
<tr class="odd">
<td align="left"><code>OCI:</code></td>
<td align="left"><code>OCI</code></td>
</tr>
<tr class="even">
<td align="left"><code>ODBC:</code></td>
<td align="left"><code>ODBC</code></td>
</tr>
<tr class="odd">
<td align="left"><code>PG:</code></td>
<td align="left"><code>PostgreSQL</code></td>
</tr>
<tr class="even">
<td align="left"><code>SDE:</code></td>
<td align="left"><code>SDE</code></td>
</tr>
</tbody>
</table>
</div>
<div id="dataset-and-layer-reading-or-creation-options" class="section level3">
<h3 class="hasAnchor">
<a href="#dataset-and-layer-reading-or-creation-options" class="anchor"></a>Dataset and layer reading or creation options</h3>
<p>Various GDAL drivers have options that influences the reading or writing process, for example what the driver should do when a table already exists in a database: append records to the table or overwrite it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">st_write</span>(<span class="kw">st_as_sf</span>(meuse), <span class="st">"PG:dbname=postgis"</span>, <span class="st">"meuse"</span>, 
    <span class="dt">layer_options =</span> <span class="st">"OVERWRITE=true"</span>)</code></pre></div>
<p>In case the table exists and the option is not specified, the driver will give an error. Driver-specific options are documented in the driver manual of <a href="http://www.gdal.org/ogr_formats.html">gdal</a>. Multiple options can be given by multiple strings in <code>options</code>.</p>
<p>For <code>st_read</code>, there is only <code>options</code>; for <code>st_write</code>, one needs to distinguish between <code>dataset_options</code> and <code>layer_options</code>, the first related to opening a dataset, the second to creating layers in the dataset.</p>
</div>
</div>
<div id="reading-and-writing-directly-to-and-from-spatial-databases" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-and-writing-directly-to-and-from-spatial-databases" class="anchor"></a>Reading and writing directly to and from spatial databases</h2>
<p>Package <code>sf</code> supports reading and writing from and to spatial databases using the <code>DBI</code> interface. So far, testing has mainly be done with <code>PostGIS</code>, other databases might work but may also need more work. An example of reading is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RPostgreSQL) 
conn =<span class="st"> </span><span class="kw">dbConnect</span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/RPostgreSQL/topics/PostgreSQL">PostgreSQL</a></span>(), <span class="dt">dbname =</span> <span class="st">"postgis"</span>) 
meuse =<span class="st"> </span><span class="kw">st_read</span>(conn, <span class="st">"meuse"</span>)
meuse_1_3 =<span class="st"> </span><span class="kw">st_read</span>(conn, <span class="dt">query =</span> <span class="st">"select * from meuse limit 3;"</span>) 
<span class="kw">dbDisconnect</span>(conn) </code></pre></div>
<p>We see here that in the second example a query is given. This query may contain spatial predicates, which could be a way to work through massive spatial datasets in R without having to read them completely in memory.</p>
<p>Similarly, tables can be written:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">conn =<span class="st"> </span><span class="kw">dbConnect</span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/RPostgreSQL/topics/PostgreSQL">PostgreSQL</a></span>(), <span class="dt">dbname =</span> <span class="st">"postgis"</span>)
<span class="kw">st_write</span>(conn, meuse, <span class="dt">drop =</span> <span class="ot">TRUE</span>)
<span class="kw">dbDisconnect</span>(conn)</code></pre></div>
<p>Here, the default table (layer) name is taken from the object name (<code>meuse</code>). Argument <code>drop</code> informs to drop (remove) the table before writing; logical argument <code>binary</code> determines whether to use well-known binary or well-known text when writing the geometry (where well-known binary is faster and lossless).</p>
</div>
<div id="conversion-to-other-formats-wkt-wkb-sp" class="section level2">
<h2 class="hasAnchor">
<a href="#conversion-to-other-formats-wkt-wkb-sp" class="anchor"></a>Conversion to other formats: WKT, WKB, sp</h2>
<div id="conversion-to-and-from-well-known-text" class="section level3">
<h3 class="hasAnchor">
<a href="#conversion-to-and-from-well-known-text" class="anchor"></a>Conversion to and from well-known text</h3>
<p>The usual form in which we see simple features printed is well-known text:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/st.html">st_point</a></span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))
## POINT (0 1)
<span class="kw"><a href="../reference/st.html">st_linestring</a></span>(<span class="kw">matrix</span>(<span class="dv">0</span>:<span class="dv">9</span>,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>))
## LINESTRING (0 1, 2 3, 4 5, 6 7, 8 9)</code></pre></div>
<p>We can create these well-known text strings explicitly using <code>st_as_wkt</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="kw"><a href="../reference/st.html">st_linestring</a></span>(<span class="kw">matrix</span>(<span class="dv">0</span>:<span class="dv">9</span>,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>))
str =<span class="st"> </span><span class="kw">st_as_text</span>(x)
x
## LINESTRING (0 1, 2 3, 4 5, 6 7, 8 9)</code></pre></div>
<p>We can convert back from WKT by using <code>st_as_sfc</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">st_as_sfc</span>(str)
## Geometry set for 1 feature 
## geometry type:  LINESTRING
## dimension:      XY
## bbox:           xmin: 0 ymin: 1 xmax: 8 ymax: 9
## epsg (SRID):    NA
## proj4string:    NA
## LINESTRING (0 1, 2 3, 4 5, 6 7, 8 9)</code></pre></div>
</div>
<div id="conversion-to-and-from-well-known-binary" class="section level3">
<h3 class="hasAnchor">
<a href="#conversion-to-and-from-well-known-binary" class="anchor"></a>Conversion to and from well-known binary</h3>
<p>Well-known binary is created from simple features by <code>st_as_binary</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="kw"><a href="../reference/st.html">st_linestring</a></span>(<span class="kw">matrix</span>(<span class="dv">0</span>:<span class="dv">9</span>,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>))
(<span class="dt">x =</span> <span class="kw">st_as_binary</span>(x))
##  [1] 01 02 00 00 00 05 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
## [24] f0 3f 00 00 00 00 00 00 00 40 00 00 00 00 00 00 08 40 00 00 00 00 00
## [47] 00 10 40 00 00 00 00 00 00 14 40 00 00 00 00 00 00 18 40 00 00 00 00
## [70] 00 00 1c 40 00 00 00 00 00 00 20 40 00 00 00 00 00 00 22 40
<span class="kw">class</span>(x)
## [1] "raw"</code></pre></div>
<p>The object returned by <code>st_as_binary</code> is of class <code>WKB</code> and is either a list with raw vectors, or a single raw vector. These can be converted into a hexadecimal character vector using <code>rawToHex</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rawToHex.html">rawToHex</a></span>(x)
## [1] "0102000000050000000000000000000000000000000000f03f000000000000004000000000000008400000000000001040000000000000144000000000000018400000000000001c4000000000000020400000000000002240"</code></pre></div>
<p>Converting back to <code>sf</code> uses <code>st_as_sfc</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="kw">st_as_binary</span>(<span class="kw"><a href="../reference/sfc.html">st_sfc</a></span>(<span class="kw"><a href="../reference/st.html">st_point</a></span>(<span class="dv">0</span>:<span class="dv">1</span>), <span class="kw"><a href="../reference/st.html">st_point</a></span>(<span class="dv">5</span>:<span class="dv">6</span>)))
<span class="kw">st_as_sfc</span>(x)
## Geometry set for 2 features 
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 0 ymin: 1 xmax: 5 ymax: 6
## epsg (SRID):    NA
## proj4string:    NA
## POINT (0 1)
## POINT (5 6)</code></pre></div>
</div>
<div id="conversion-to-and-from-sp" class="section level3">
<h3 class="hasAnchor">
<a href="#conversion-to-and-from-sp" class="anchor"></a>Conversion to and from sp</h3>
<p>Spatial objects as maintained by package <code>sp</code> can be converted into simple feature objects or geometries by <code>st_as_sf</code> and <code>st_as_sfc</code>, respectively:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">methods</span>(st_as_sf)
## [1] st_as_sf.data.frame* st_as_sf.lpp*        st_as_sf.map*       
## [4] st_as_sf.ppp*        st_as_sf.psp*        st_as_sf.sf*        
## [7] st_as_sf.Spatial*   
## see '?methods' for accessing help and source code
<span class="kw">methods</span>(st_as_sfc)
##  [1] st_as_sfc.bbox*               st_as_sfc.blob*              
##  [3] st_as_sfc.character*          st_as_sfc.dimensions*        
##  [5] st_as_sfc.factor*             st_as_sfc.list*              
##  [7] st_as_sfc.map*                st_as_sfc.raw*               
##  [9] st_as_sfc.SpatialLines*       st_as_sfc.SpatialMultiPoints*
## [11] st_as_sfc.SpatialPixels*      st_as_sfc.SpatialPoints*     
## [13] st_as_sfc.SpatialPolygons*    st_as_sfc.WKB*               
## see '?methods' for accessing help and source code</code></pre></div>
<p>An example would be:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sp)
<span class="kw">data</span>(meuse)
<span class="kw"><a href="http://www.rdocumentation.org/packages/sp/topics/coordinates">coordinates</a></span>(meuse) =<span class="st"> </span><span class="er">~</span>x+y
m.sf =<span class="st"> </span><span class="kw">st_as_sf</span>(meuse)
opar =<span class="st"> </span><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>))
<span class="kw">plot</span>(m.sf)
## Warning: plotting the first 10 out of 12 attributes; use max.plot = 12 to
## plot all</code></pre></div>
<p><img src="sf2_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>Conversion of simple feature objects of class <code>sf</code> or <code>sfc</code> into corresponding <code>Spatial*</code> objects is done using the <code>as</code> method, coercing to <code>Spatial</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="kw"><a href="../reference/sfc.html">st_sfc</a></span>(<span class="kw"><a href="../reference/st.html">st_point</a></span>(<span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>)), <span class="kw"><a href="../reference/st.html">st_point</a></span>(<span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)), <span class="dt">crs =</span> <span class="dv">4326</span>)
<span class="kw">as</span>(x, <span class="st">"Spatial"</span>)
## SpatialPoints:
##      coords.x1 coords.x2
## [1,]         5         5
## [2,]         6         9
## Coordinate Reference System (CRS) arguments: +proj=longlat
## +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0</code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#reading-and-writing-through-gdal">Reading and writing through GDAL</a></li>
      <li><a href="#reading-and-writing-directly-to-and-from-spatial-databases">Reading and writing directly to and from spatial databases</a></li>
      <li><a href="#conversion-to-other-formats-wkt-wkb-sp">Conversion to other formats: WKT, WKB, sp</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Edzer Pebesma.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  
</body>
</html>
